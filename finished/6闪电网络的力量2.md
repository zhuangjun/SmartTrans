> 本文翻译自：https://medium.com/coinmonks/powered-by-lightning-part-2-5ef1e76e4288
>
> 译者：[区块链中文字幕组](https://github.com/BlockchainTranslator/EOS) [小丹](https://github.com/zhuangjun)
>
> 翻译时间：2018-10-26

----------------------------------------------------


将来，我们将能够在以下付款时间内使用LN：

* 点对点支付
* 支付商家
* 可编程资金（游戏，流媒体娱乐，服务，物联网等）

我们将看看每个场景，并讨论如何使用比特币和闪电网络完成。

### 输入比特币

首先，Alice如何拥有比特币？爱丽丝通过与菲亚特一起购买并将她的比特币撤回到她的移动和硬件钱包中，通过某种交易所购买它。用于小型，快速购买的移动钱包，通常被称为“热钱包”和用于存储大部分比特币以保证安全的硬件钱包，通常被称为“冷钱包”。

以下是典型流程：

![][2]

购买和取出比特币

在一个使用闪电网络的未来，爱丽丝将会做出与众不同的事情。从她目前用作热钱包的同一个钱包，她将与她的交换开启一个通道，创建她的第一个闪电通道。

> “开放通道”的语义很可能会在未来的比特币钱包中被删除，以避免混淆用户。相反，用户将拥有一个“闪电钱包”，它将拥有能够代表用户无缝打开通道的软件（自动驾驶仪）;这些通道将通过许多不同的节点打开，而不仅仅是交换节点。

从Alice的移动设备访问闪电钱包，但移动设备能够在第1层和第2层保持比特币。未来的移动钱包应用应该努力在两层之间拥有非常清晰的用户体验;最有可能将闪电钱包当作“日常现金账户”，将区块链钱包当作“储蓄账户”。然后硬件钱包将是“定期存款”或“超级基金”。

我们很快就会明白为什么她的手机钱包应该同时拥有第1层和第2层比特币。只是一张纸条;第1层比特币总是与第2层比特币相同，但第1层比特币可以被视为无阻碍，而第2层比特币已被签署为条件钱包。为了与遗留金融系统相关，第1层比特币类似于银行账户中的现金，而第2层比特币类似于您的Paypal余额 - 它是相同的现金，但您和Paypal都对您的Paypal余额进行监督。

> 注意：使用比特币，您的资产永远不会在第1层或第2层被占用，这与银行账户和您的PayPal余额不同，后者只是数据库特殊结构，可以随时擦除。

![][5]

爱丽丝用她的Exchange打开一个闪电通道。

Alice现在可以执行以下操作：

* 将比特币添加到她的闪电钱包中，或将其取出
* 从闪电钱包中花掉比特币

#### 添加和撤销比特币

爱丽丝希望继续增加她的比特币钱包。她可以通过以下方式做到这一点：

1. 将现金发送给她的交易所
2. 直接从她的移动区块链钱包中添加比特币
3. 直接从她的硬件钱包中添加比特币

将比特币直接添加到她的Lightning Wallet被称为“拼接”，Alice可以从她拥有的任何其他链式钱包中拼接出来。当Alice向交易所发送现金并购买比特币时，交易所将从他们的连锁钱包拼接到她的渠道。

![][7]

爱丽丝可以通过向她的交易所发送现金来继续填充她的闪电钱包

对Alice来说，这一切都完全无缝。她可以看到她的闪电钱包的平衡，并能够从她想要的任何机制中添加它。在引擎盖下，她的钱包正在进行一系列原子链上交易，以便将她的比特币放入她的闪电钱包中。

撤回比特币只是反过来的上述行为：

1. 将比特币提取到现金：通过她的交易所撤回
2. 将比特币提取到她的第1层钱包：从闪电钱包中拼出来
3. 把比特币拿到她的冷钱包里：从闪电钱包里掏出来

#### 花费比特币

一旦爱丽丝拥有一个带有天平的闪电钱包，她就可以花在闪电网络上的任何其他人身上。她输入收件人的地址并发送付款。她的手机钱包执行以下操作：

* 计算到鲍勃的最佳路线
* 发送付款并等待收据

![][9]

在Alice用她的本地交换机打开她的通道的情况下，支付将首先通过交换机节点路由，这是“网关节点”。支付路由中的最后一个节点将是Bob的钱包首次连接到的节点，也称为网关节点。这很可能是一个交换节点，因为交换节点处于最佳位置，可以有效地将新用户安装到闪电网络上。桥节点是与其他节点打开信道的节点，并且具有比传入更多的流出流动性。

网关节点在支付流程中执行重要功能，可以创建或破坏Alice的支付体验。幸运的是，现在正在进行大量创新，所以我们将讨论这个问题。

> Alice和Bob有兴趣打开具有不同网关节点的多个通道，以实现隐私，冗余和可靠性。

#### 问题

讨论了上述支付流程中的一些直接问题及其解决方案：

1. 鲍勃没有闪电钱包。

> 在这种情况下，Alice的智能手机钱包将检测到Bob的地址不是闪电地址，而是无缝地发送Bob Layer 1比特币。

2\. Alice的闪电钱包没有足够的比特币在第1层或第2层付款。

> 未来的智能手机钱包将告知爱丽丝，她需要为自己的闪电钱包充值，或者退出闪电钱包。

3\. 鲍勃不在线接收他的照明付款

> 如果Bob因为不在线而无法收到付款，那么它将失败并返回Alice。然后，Alice的钱包将要求Alice向Bob支付第1层比特币，如果Bob不在线，可以发送第1层比特币。

4\. Alice选择的支付路线因流动性或可靠性而失败

>  Alice的智能钱包将能够以不同的路线重新尝试付款。

5\. Bob的节点没有足够的比特币来路由到Bob。

> 对于鲍勃收到100美元，那么100美元需要在鲍勃通道的另一边;即与他的交流。情况可能并非如此，在这种情况下，Alice不会通过鲍勃或爱丽丝的过错向Bob支付费用。解决方案是让Alice直接与Bob打开一个通道。

我们可以看到围绕Bob和他的节点传播的主要问题。如果Alice遇到任何有关其付款选择或流动性的问题，她可以在发送付款之前进行更正。然而，她受鲍勃支付限制和他的节点的支配。

对此的解决方案是Bob在他的节点上接收付款而不是直接到他的钱包。然后，他的节点可以通过电子邮件，短信或推送通知通知他收到的付款，然后他就可以上网并将任何收款都提取到他的钱包中。

Bob可以选择运行他自己的节点，或者他可以在他启用闪电的交换机上开设一个账户，并让他们的节点为他累积付款。

![][11]

Bob收到收到付款的通知

#### 电子商务和支付商家

尽管上面讨论了一些问题，但向同行付款相当容易，但Lightning在支付商家或进行电子商务付款时会自行支付。

这样做的主要原因是商家和电子商务支付解决方案将运行他们自己的基础设施，并且不会完全关心验证每笔付款。相反，他们将累积每日收入，并循环批量提款。

此外，商家更可能选择接收传统法定货币或稳定币的付款，以支付税款，工资和其他业务费用。因此，更有意义的是，他们将在当地交易所拥有商户账户，并让交易所处理收款。

![][13]

商家可能会使用Exchange基础结构

### **原子多路径支付（AMP**

我们之前提到，爱丽丝的钱包将能够选择通往鲍勃的路线，但这只是表面上的问题。

AMP是一项革命性的功能，尚未建立在Lightning之上，因为它只是[最近构思][14]。目前Lightning的主要问题是只能在已经拥有流动资金的渠道之间进行付款，即10美元的付款只能通过已经有10美元的渠道发送。

AMP允许支付一次性通过多个不同的渠道原子发送，Bob将接收所有这些，或者不接收任何一个。例如，爱丽丝希望向Bob支付1000美元。 Alice可以发送1000美元的1美元付款，而不是发送可能会失败的1000美元付款。每次付款都会通过不同的路线，当Bob收到所有付款时，他将获得全额1000美元。

当我们认为Lightning允许单播付款时，AMP允许_multi-cast_付款。这对Lightning的以下特性有突破性的改进：

1. **可靠性。**每个通道都很可能已经拥有1美元，因此支付的整体可靠性将很快达到100％。
2. **费用具有竞争力。**试图收取高额费用的节点将很快失去路线选择并将失去流量。他们将不得不收取极具竞争力的费用以吸引流量。

![][16]

AMP付款

在此图中，Alice向Bob支付10美元，并支付两笔5美元的款项。选择路线以最大化可靠性和流动性。我们可以看到，除了网关节点之外，没有任何一个节点知道完整的支付规模，也没有人知道谁支付谁。因此，通过网络进行的支付越多，重新平衡的速度就越快，整个网络的健康状况就越健康。这完全归功于AMP。

### 可编程货币

Lightning使比特币成为可编程货币。将来，Alice的所有设备都会有一个照明钱包，以便他们能够以编程方式代表Alice快速付款。她的自动驾驶汽车，她的手机，冰箱都有钱包，爱丽丝可以制定关于如何支付的规定，以及多少钱。如：

* 电话支付快速上网每月不超过10美元
* 冰箱为她的杂货账单每周支付200美元，由她的菜单设置
* 汽车每月花费不超过10美元的通行费

爱丽丝将能够从她的主要钱包中获得最高价，为他们提供流动资金。每当他们变低时，她都会得到通知，以及他们代表她花多少钱。因为他们只会在爱丽丝的允许下度过，所以爱丽丝永远不会因为她不知道的事情而受到指控，她将完全控制消费。

爱丽丝永远不会花更多的钱，这意味着她永远不会累积债务。

![][18]

金钱的未来

### 每个房子里的一个节点

我们可以看到，闪电网络的健康和可用性实际上归结为可用的节点和资助渠道的数量。此外，Alice，Bob和商家的最佳利益是运行他们自己的节点，因为他们可以围绕费用，流动性和隐私做出更好的选择。

好处是运行Lightning节点很快就会成为一件非常微不足道的事情，以至于未来的家庭将互联网路由器与比特币和Lightning节点捆绑在一起。每个家庭的成员只需将他们的移动钱包与他们自己的节点连接起来，它就会像现在一样全天候运行。

一些令人敬畏的节点投入生产包括[Casa Node][19]和[RaspiBlitz][20]。

确保所有人都可以访问未来的比特币网络，以便任何人都可以在家中托管节点，这一点变得越来越重要。因此，我坚定地参加Segwit + 1mb区块限制营。目前比特币链是185GB，在典型设备上需要大约一天的时间来同步。通过预先加载预先验证的链组，可以快速同步单片机（RPi）。

我们将在本系列的第5部分讨论我们如何可以预见到整个世界在比特币和闪电网络上使用_no change_到当前的比特币区块链参数，以及当前比特币设计选择带来的巨大好处我们。

### 结论

闪电是对我们如何使用和支出比特币的巨大改进，并且是我们正在逐步过渡到完全控制支出的无债务，可编程资金的更广泛运动的一部分。

但是，我们如何使用Lightning存在一些限制，主要是在付款接收方周围。好消息是，该领域正在进行大量的创新，大多数问题都可能很容易解决。

从这里开始：

### 致谢

非常感谢@ln_master_hub和[BTCPay Server][21]给我反馈本文和一些技术内容。

[1]: https://cdn-images-1.medium.com/freeze/max/75/1*HdEa1dDLpS5oARt6bdLkEw.png?q=20
[2]: https://cdn-images-1.medium.com/max/2000/1*HdEa1dDLpS5oARt6bdLkEw.png
[3]: https://cdn-images-1.medium.com/freeze/max/75/1*0_s_nZmOI8J6aRjiPm4dWA.png?q=20
[4]: https://medium.com/coinmonks/undefined
[5]: https://cdn-images-1.medium.com/max/2000/1*0_s_nZmOI8J6aRjiPm4dWA.png
[6]: https://cdn-images-1.medium.com/freeze/max/75/1*VKKWuJePgDZceb8Hv3CzGA.png?q=20
[7]: https://cdn-images-1.medium.com/max/2000/1*VKKWuJePgDZceb8Hv3CzGA.png
[8]: https://cdn-images-1.medium.com/freeze/max/75/1*5IeUobntmEAeYp7zSL1IAQ.png?q=20
[9]: https://cdn-images-1.medium.com/max/2000/1*5IeUobntmEAeYp7zSL1IAQ.png
[10]: https://cdn-images-1.medium.com/freeze/max/75/1*gy3KJppKCj47xFzhhOU3kw.png?q=20
[11]: https://cdn-images-1.medium.com/max/2000/1*gy3KJppKCj47xFzhhOU3kw.png
[12]: https://cdn-images-1.medium.com/freeze/max/75/1*7pSMjQ6Wo357uqgIS9R1tA.png?q=20
[13]: https://cdn-images-1.medium.com/max/2000/1*7pSMjQ6Wo357uqgIS9R1tA.png
[14]: https://lists.linuxfoundation.org/pipermail/lightning-dev/2018-February/000993.html
[15]: https://cdn-images-1.medium.com/freeze/max/75/1*0eAD3iOyWTr69_NnBAOmlQ.png?q=20
[16]: https://cdn-images-1.medium.com/max/2000/1*0eAD3iOyWTr69_NnBAOmlQ.png
[17]: https://cdn-images-1.medium.com/freeze/max/75/1*SY47XnjsrWxcFBItyGWhLQ.png?q=20
[18]: https://cdn-images-1.medium.com/max/2000/1*SY47XnjsrWxcFBItyGWhLQ.png
[19]: https://store.casa/lightning-node/
[20]: https://github.com/rootzoll/raspiblitz
[21]: https://medium.com/@BtcpayServer



#### 区块链中文字幕组

致力于前沿区块链知识和信息的传播，为中国融入全球区块链世界贡献一份力量。

如果您懂一些技术、懂一些英文，欢迎加入我们，加微信号:w1791520555。

[点击查看项目GITHUB，及更多的译文...](https://github.com/BlockchainTranslator/EOS)

#### 本文译者简介

小丹 区块链技术爱好者  热衷于区块链底层技术研究

版权所有，转载需完整注明以上内容。

----------------------------------------------------
