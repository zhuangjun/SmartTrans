> 本文翻译自：https://blog.trailofbits.com/2018/10/22/a-guide-to-post-quantum-cryptography/
>
> 译者：[区块链中文字幕组](https://github.com/BlockchainTranslator/EOS) [小丹](https://github.com/zhuangjun)
>
> 翻译时间：2018-11-06

----------------------------------------------------

# 后量子密码学指南

对于许多高保障应用，如TLS流量，医疗数据库和区块链，前向保密绝对必不可少。仅防止攻击者立即解密敏感信息是不够的。在这里，威胁模型包括攻击者在收集密文后可能多年致密解密文的情况。可能被打破的一个潜在的前方保密方式是，增加的计算能力和数量理论突破的组合使得攻击当前密码易于处理。但是，除非有人找到用于分解大整数的多项式时间算法，否则当前最佳实践的风险很小。我们应该更加关注量子计算机的成功开发，因为这样的突破将使我们今天使用的大多数加密技术变得不安全。

## 量子计算入门

[量子计算机不仅仅是大规模并行的经典计算机][3]。人们常常认为，由于量子比特可以同时占据0和1，因此n比特量子计算机可以同时处于2n个状态，因此可以非常快速地计算NP完全问题。情况并非如此，因为测量量子态会破坏大部分原始信息。例如，量子系统完全了解物体的动量和位置，但任何动量测量都会破坏有关位置的信息，反之亦然。这被称为[海森堡不确定性原理][4]。因此，成功的量子算法由量子比特的一系列变换组成，使得在计算结束时，测量系统的状态不会破坏所需的信息。事实上，[已经证明][5]不存在量子算法同时尝试所有解决某些NP完全问题的方法并输出正确的输入。换句话说，任何用于解决硬经典问题的量子算法都必须利用手头问题的具体结构。今天，有两种这样的算法可用于密码分析。

快速计算大数的能力将破坏RSA和离散的基于日志的加密。整数分解的最快算法是一般数字域筛，它在亚指数时间内运行。然而，在1994年，Peter Shor开发了一种量子算法（[Shor算法][6]），用于在多项式时间内运行的整数分解，因此可以破坏任何RSA或离散的基于对象的密码系统（包括使用椭圆曲线的那些） 。这意味着如果有人要构建量子计算机，那么所有广泛使用的公钥密码术都是不安全的。

第二个是Grover的算法，它能够在O（√n）时间内反转函数。该算法会通过根因子降低对称密钥加密的安全性，因此AES-256只能提供128位的安全性。类似地，找到256位哈希函数的前映像只需要2128次。由于将哈希函数或AES的安全性提高了两倍并不是非常繁琐，因此Grover的算法不会对对称加密造成严重威胁。此外，建议用于加密使用的伪随机数发生器都不会受到量子计算机发明的影响，除了Grover算法引起的O（√n）因子。

## 后量子算法的类型

后量子密码学是对密码系统的研究，它可以在经典计算机上运行，​​但即使对手拥有量子计算机也是安全的。最近，[NIST发起][7]标准化后量子加密的过程，目前正在审查第一轮提交。这些提交中最有希望的包括基于格子，同基因，哈希函数和代码的密码系统。

在深入研究每类提交之前，我们简要总结一下每种类型的密码系统固有的权衡，并与当前（非后量子）椭圆曲线密码学进行比较。请注意，代码和同基因能够生成数字签名，但没有向NIST提交此类方案。


|    | 签名  | 密钥交换  | 快速? |
| -|-|-|- |
|  椭圆曲线 |  64字节 |  32字节 |  ✓ |  
|  格子 |  2.7kb |  1 kb |  ✓ |  
|  同源 |  ✗ |  330 bytes |  ✗ |  
|  代码 |  ✗ |  1 mb |  ✓ |  
|  哈希函数 |  41 kb |  ✗ |  ✓ | 

表1：提交给NIST的经典ECC与后量子方案的比较

在安全性证明方面，上述密码系统都没有减少到NP难（或NP完全）问题。在格子和代码的情况下，这些密码系统基于NP难问题的轻微修改。基于哈希的构造依赖于良好哈希函数的存在，并且不进行其他加密假设。最后，基于同基因的密码学基于一个被推测为难的问题，但与NP难问题或先前的加密假设不相似。然而，值得一提的是，正如我们无法证明任何经典算法在多项式时间内都不易破碎（因为P可能等于NP），可能是量子计算机认为难以解决的问题。此外，由于整数因子分解和离散对数问题不被认为是NP完全的，因此不会减少到某些NP难或完全问题的密码系统不应该是对它的标记。

### 格子

在后量子加密的所有方法中，格子是最活跃的研究和最灵活的。它们具有很强的安全性，可以进行密钥交换，数字签名以及[完全同态加密]等更复杂的构造[8]。尽管格子密码系统的优化和安全性证明都需要极其复杂的数学，但基本思想只需要基本的线性代数。假设您有一个形式的线性方程组

![][9]

求解**x**是一个经典的线性代数问题，可以使用高斯消元法快速求解。另一种思考方式是我们有一个神秘的功能，

![][10]

给定一个向量**a**的地方，我们看到**ax**的结果，而不知道**x**。在查询了这个函数足够多次之后，我们可以在很短的时间内学习f（通过求解上面的方程组）。这样我们就可以将线性代数问题重新定义为机器学习问题。

现在，假设我们向函数引入了少量噪声，因此在将**x**和**a**，我们添加一个错误项**e**并减少整个事物模数（中等）素数q。然后我们嘈杂的神秘功能看起来像

![][11]

学习这种嘈杂的神秘功能已经在数学上被证明是非常困难的。直觉是在我们在非噪声情况下使用的高斯消除过程的每一步中，误差项变得越来越大，直到它超越了关于函数的所有有用信息。在密码学文献中，这被称为[有错误的学习][12]问题（LWE）。

基于LWE的密码学被称为基于格的密码学的原因是因为LWE难以证明依赖于在称为格子的东西中找到最短向量的事实已知为NP-Hard。我们不会在这里深入研究格子的数学，但可以认为格子是n维空间的平铺

![][13]

格子由坐标向量表示。在上面的例子中，通过组合**e1**, **e2**, 和 **e3**（通过法线向量加法）可以达到格子中的任何点。最短向量问题（SVP）说：给定一个点阵，找到长度为向量的元素最短。这很难的直观原因是因为并非所有给定晶格的坐标系都同样易于使用。在上面的例子中，我们可以用三个非常长且靠近的坐标向量来表示晶格，这使得寻找靠近原点的向量更加困难。事实上，有一种规范的方法可以找到格子的“最坏可能”表示。当使用这样的表示时，已知最短向量问题是NP难的。

在研究如何使用LWE进行量子抗性密码学之前，我们应该指出LWE本身不是NP-Hard。它不是直接减少到SVP，而是减少到实际推测为不是NP-Hard的SVP的近似值。尽管如此，目前还没有用于求解LWE的多项式（或次指数）算法。

现在让我们使用LWE问题来创建一个实际的密码系统。最简单的方案是由Oded Regev在他的[原始论文][14]中创建的，证明了LWE问题的硬度。这里，秘密密钥是具有整数条目modq的n维向量，即上面提到的LWE秘密。公钥是前面讨论的矩阵**A**，以及LWE函数的输出向量

![][15]

![][16]

这个公钥的一个重要特性是，当它乘以向量(**-sk**,1)时，我们得到错误项，大致为0。

为了加密一些信息m，我们取结果的最后一个坐标中的**A**和编码m的总和，加上0，如果m是0和q/2如果m是1。换句话说，我们选择一个0或1的随机向量**x**，并进行计算

![CodeCogsEqn \(3\)][17]

直觉上，我们刚刚评估了LWE函数（我们知道它很难破解）并在此函数的输出中编码了我们的位。

解密是有效的，因为知道LWE秘密将允许收件人收回消息，加上一个小错误术语

![][18]

当正确选择错误分布时，它永远不会使消息失真超过q/4。接收者可以测试输出是否更接近0或q/2 mod q并相应地解码该位。

该系统的一个主要问题是它具有非常大的密钥。要加密一位信息，需要安全参数中大小为n2的公钥。然而，格子密码系统的一个吸引人的方面是它们非常快。

自Regev的原始论文以来，围绕基于格的密码系统进行了大量工作。改进其实用性的关键突破是Ring-LWE的开发，这是LWE问题的变体，其中键由某些多项式表示。这导致密钥大小的二次减少，加速加密和解密，仅使用n*log(n)操作（使用快速傅里叶技术）。

在考虑用于NIST PQC标准的许多基于晶格的密码系统中，特别值得一提的两个是晶体结构，[Kyber][19]和[Dilithium][20]。

Kyber是一种密钥封装机制（KEM），它遵循与上述系统类似的结构，但使用一些花哨的代数数论来获得比Ring-LWE更好的性能。对于合理的安全参数，密钥大小约为1kb（仍然很大！）但加密和解密时间大约为0.075毫秒。考虑到这种速度是通过软件实现的，Kyber KEM似乎很有希望进行后量子密钥交换。

达丽星是一种基于类似Kyber技术的数字签名方案。它的详细信息超出了本博文的范围，但值得一提的是它也实现了相当不错的性能。公钥大小约为1kb，签名为2kb。它也非常高效。在Skylake处理器上，计算签名所需的平均周期数约为200万。验证平均需要390,000个周期。

### 代码

纠错码的研究在计算机科学文献中有着悠久的历史，可以追溯到Richard Hamming和Claude Shannon的突破性工作。虽然我们甚至无法在一篇简短的博客文章中开始探讨这个[深层领域][21]的表面，但我们给出了一个快速概述。

在传递二进制消息时，错误可能以位翻转的形式发生。纠错码提供了以消息紧凑性为代价承受一定数量的位翻转的能力。例如，我们可以通过将0编码为000而将1编码为111来防止单比特翻转。这样，接收器可以通过对三个比特进行多数表决来确定101实际上是111，或者001是0。但是，这个代码无法纠正两个位被翻转的错误，因为转换为001的111将被解码为0。

最突出的纠错码类型称为线性码，可以用kxn矩阵表示，其中k是原始消息的长度，n是编码消息的长度。通常，在不知道底层线性代码的情况下解码消息在计算上是困难的。这种硬度支撑着[McEliece公钥密码系统][22]的安全性。

在高级别，McEliece系统中的密钥是来自称为[Goppa代码][23]的一类代码的随机代码（表示为矩阵**G**）。公钥是矩阵**SGP**，其中**S**是带有二进制条目的可逆矩阵，而**P**是一个置换。要加密消息**m**，发送方计算**c = m（SGP）+ e**，其中**e**是一个随机错误向量，其中包含错误的数量代码能够纠正。为了解密，我们计算** cP-1 = mSG + eP-1 **，这样** mS **是一个** G **的代码字，可以纠正添加的错误项** Ë**。通过计算**mSS-1**可以很容易地恢复该消息。

与格子一样，基于代码的密码术也存在密钥是大矩阵的事实。使用[推荐的安全参数][24]，McEliece公钥大约为1 mb，私钥为11 kb。目前[正在进行的工作][25]试图使用称为准循环中等密度奇偶校验码的特殊类代码，这些代码可以比Goppa代码更简洁地表示，但是这些代码的安全性比Goppa研究得少。码。

### Isogenies

椭圆曲线密码学领域因使用相当多的奥术数学而臭名昭着。 [Isogenies][26]将此提升到一个全新的水平。在椭圆曲线加密中，我们使用Diffie-Hellman类型协议来获取共享秘密，但是我们不是将组元素提升到某个幂，而是遍历椭圆曲线上的点。在基于同基因的密码学中，我们再次使用Diffie-Hellman类型协议，但我们不是通过椭圆曲线上的点遍历，而是通过一系列椭圆曲线本身。

![][27]

来自[_An介绍基于超奇异基因的密码学][28] _

isogeny是一种将一条椭圆曲线转换为另一条椭圆曲线的函数，使得第一条曲线的组结构在第二条曲线中反映出来。对于那些熟悉群论的人来说，它是一个群同态，有一些[添加结构处理每条曲线的几何][29]。当我们将注意力限制在[超奇异椭圆曲线][30]（这里我们不会定义）时，每条曲线都保证有一定数量的同基因从它到其他超奇异曲线。

现在，考虑通过从我们的起始曲线检查该形式的所有同基因，然后从这些曲线中检查所有同基因来创建的图，依此类推。这个图表在高度结构化的意义上说，如果我们从第一条曲线开始随机游走，击中特定其他曲线的概率可以忽略不计（除非我们采取指数级的步骤）。在数学术语中，我们说通过检查所有这些同基因产生的图是[扩展图][31]（以及[Ramanujan][32]）。这种扩展特性正是使基于同基因的密码学安全的原因。

对于[Supersingular Isogeny Diffie-Hellman][33]（SIDH）方案，秘密密钥是同系链，公钥是曲线。当Alice和Bob组合这些信息时，他们会获得不同的曲线，但具有相同的[j-invariant][34]。对于加密的目的而言，j-invariant不是那么重要，而是它是Alice和Bob完成密钥交换后可以很容易地计算的数字。

与其他后量子方案相比，基于isogeny的密码学具有极小的密钥大小，仅使用330个字节用于公钥。不幸的是，在这篇文章中讨论的所有技术中，它们是最慢的，[密钥生成和共享秘密计算需要11-13毫秒][35]。然而，他们确实支持完美的前向保密，这不是其他后量子密码系统所拥有的。

### 基于哈希的签名

已经有很多[基于哈希的签名的友好介绍][36]，所以我们对它们的讨论相当高级。简而言之，哈希签名使用哈希函数的输入作为密钥并输出作为公钥。这些密钥仅适用于一个签名，因为签名本身会显示秘密密钥的一部分。基于哈希的签名的这种极端低效导致使用[Merkle trees][37]来减少空间消耗（是的，比特币中使用的Merkle树相同）。

不幸的是，不可能用哈希构造KEM或公钥加密方案。因此，基于哈希的签名不是完整的后量子密码解决方案。而且，它们不是空间有效的;一个更有前途的签名方案，[SPHINCS][38]，产生41kb的签名和1kb的公钥/私钥。另一方面，基于哈希的方案非常快，因为它们只需要计算哈希函数。它们还具有极强的安全性证据，完全基于存在具有抗冲突和抗图像抗性的哈希函数的假设。由于没有任何迹象表明当前广泛使用的哈希函数（如SHA3或BLAKE2）容易受到这些攻击，因此基于哈希的签名是安全的。

## 总结

后量子密码学是一个令人难以置信的令人兴奋的研究领域，在过去十年中已经取得了巨大的增长。虽然这篇文章中描述的四种类型的密码系统已经得到了很多学术上的关注，但是没有一种被NIST批准，因此不推荐用于一般用途。许多方案的原始形式不具备性能，并且受到各种优化的影响，这些优化可能会或可能不会影响安全性。实际上，多次尝试为McEliece系统使用更节省空间的代码[已被证明是不安全的][39]。就目前而言，从后量子密码系统中获得最佳安全性需要牺牲一些空间或时间。基于环形点阵的密码学是灵活性方面最有前途的工作途径（签名和KEM，也是完全同态加密），但它所基于的假设仅在几年内得到了强烈的研究。现在，最安全的赌注是使用McEliece和Goppa代码，因为它已经经受了数十年的密码分析。

但是，每个用例都是唯一的。如果你认为你可能需要后量子加密，[与我们联系][40]与友好的邻居密码学家联系。其他人应该等到NIST完成其标准化过程。

[1]: https://blog.trailofbits.com/2018/10/22/a-guide-to-post-quantum-cryptography/ "6:50 am"
[2]: https://blog.trailofbits.com/2018/10/22/a-guide-to-post-quantum-cryptography/#respond
[3]: https://www.scottaaronson.com/papers/npcomplete.pdf
[4]: https://en.wikipedia.org/wiki/Uncertainty_principle
[5]: https://arxiv.org/pdf/quant-ph/9701001.pdf
[6]: https://www.scottaaronson.com/blog/?p=208
[7]: https://csrc.nist.gov/Projects/Post-Quantum-Cryptography
[8]: https://blog.cryptographyengineering.com/2012/01/02/very-casual-introduction-to-fully/
[9]: https://trailofbits.files.wordpress.com/2018/10/image6.png?w=323&h=125
[10]: https://trailofbits.files.wordpress.com/2018/10/image2.png?w=238&h=22
[11]: https://trailofbits.files.wordpress.com/2018/10/image10.png?w=352&h=22
[12]: https://cims.nyu.edu/~regev/papers/lwesurvey.pdf
[13]: https://trailofbits.files.wordpress.com/2018/10/image5.jpg?w=690
[14]: https://cims.nyu.edu/~regev/papers/qcrypto.pdf
[15]: https://trailofbits.files.wordpress.com/2018/10/image8.png?w=282&h=115
[16]: https://trailofbits.files.wordpress.com/2018/10/image7.png?w=183&h=22
[17]: https://trailofbits.files.wordpress.com/2018/10/codecogseqn-3.png?w=279&h=37
[18]: https://trailofbits.files.wordpress.com/2018/10/image3.png?w=400&h=37
[19]: https://pq-crystals.org/kyber/
[20]: https://pq-crystals.org/dilithium/index.shtml
[21]: https://www.cs.cmu.edu/~venkatg/teaching/codingtheory/
[22]: http://www.math.unl.edu/~s-jeverso2/McElieceProject.pdf
[23]: https://en.wikipedia.org/wiki/Goppa_code
[24]: http://pqcrypto.eu.org/docs/initial-recommendations.pdf
[25]: https://eprint.iacr.org/2012/409.pdf
[26]: https://2017.pqcrypto.org/school/slides/Isogeny_based_crypto.pdf
[27]: https://trailofbits.files.wordpress.com/2018/10/image9.png?w=600&h=225
[28]: https://ecc2017.cs.ru.nl/slides/ecc2017school-costello.pdf
[29]: https://en.wikipedia.org/wiki/Morphism_of_algebraic_varieties
[30]: https://en.wikipedia.org/wiki/Supersingular_elliptic_curve
[31]: https://people.seas.harvard.edu/~salil/pseudorandomness/expanders.pdf
[32]: https://mast.queensu.ca/~murty/ramanujan.pdf
[33]: https://en.wikipedia.org/wiki/Supersingular_isogeny_key_exchange
[34]: https://en.wikipedia.org/wiki/J-invariant
[35]: https://blog.cloudflare.com/sidh-go/
[36]: https://blog.cryptographyengineering.com/2018/04/07/hash-based-signatures-an-illustrated-primer/
[37]: https://en.wikipedia.org/wiki/Merkle_tree
[38]: https://sphincs.cr.yp.to/sphincs-20150202.pdf
[39]: https://eprint.iacr.org/2009/509.pdf
[40]: https://www.trailofbits.com/contact/
[41]: https://blog.trailofbits.com/2018/10/22/a-guide-to-post-quantum-cryptography/?share=twitter "Click to share on Twitter"
[42]: https://blog.trailofbits.com/2018/10/22/a-guide-to-post-quantum-cryptography/?share=linkedin "Click to share on LinkedIn"
[43]: https://blog.trailofbits.com/2018/10/22/a-guide-to-post-quantum-cryptography/?share=reddit "Click to share on Reddit"
[44]: https://blog.trailofbits.com/2018/10/22/a-guide-to-post-quantum-cryptography/?share=telegram "Click to share on Telegram"
[45]: https://blog.trailofbits.com/2018/10/22/a-guide-to-post-quantum-cryptography/?share=facebook "Click to share on Facebook"
[46]: https://blog.trailofbits.com/2018/10/22/a-guide-to-post-quantum-cryptography/?share=email "Click to email this to a friend"
[47]: https://blog.trailofbits.com/2018/10/22/a-guide-to-post-quantum-cryptography/#print "Click to print"
[48]: https://blog.trailofbits.com/category/cryptography/



#### 区块链中文字幕组

致力于前沿区块链知识和信息的传播，为中国融入全球区块链世界贡献一份力量。

如果您懂一些技术、懂一些英文，欢迎加入我们，加微信号:w1791520555。

[点击查看项目GITHUB，及更多的译文...](https://github.com/BlockchainTranslator/EOS)

#### 本文译者简介

小丹 区块链技术爱好者  热衷于区块链底层技术研究

版权所有，转载需完整注明以上内容。

----------------------------------------------------
