
> 本文翻译自：https://medium.com/xpring/layer-3-is-for-interoperability-ca387fa5f7e2
>
> ### 一分钟导读
>分层协议架构提供了许多重要的好处：
> * 互操作性
> * 可升级性
> * 多用途案例的通用基础设施
>
> #### 区块链构架协议栈
> * 第1层：账本：
> 
> 账本注定会成为性能瓶颈，因为它们在逻辑上是集中的。无论账本是以集中还是去中心化的方式维护，它都需要一个统一的，共享的账户和余额状态，以确保资金不会“双重花费”。更新广泛共享状态总是相对昂贵且缓慢。
> * 第2层：局域网
> 
> 区块链的第2层技术旨在通过使用一种程序化托管方式在底层分类账上实现快速，廉价，高吞吐量的交易。此类别包括[支付通道][7]和[广义状态通道][8]等双边技术，以及包括[闪电网络][9]和[雷电网络][10]，[侧链]等支付通道网络的多边解决方案[11]，和[等离子][12]。通过允许成对或较小的账户持有者组进行交易而不需要每次与主分类账交互，这些中的每一个都能够实现更快，更便宜的交易。
> * 第3层：互操作性
> 
> 第3层的目的是抽象出不同的第1层和第2层技术之间的差异，以连接不同类型的网络。这是互联网上的互联网协议（IP）和价值互联网中的Interledger协议（ILP）的作用。
> 
> ILP的最小抽象实现了与所有类型的第1层和第2层网络的互操作性，包括那些不能设计为可互操作的网络。到目前为止，它已被用于连接比特币闪电网络，双边以太坊支付通道和XRP支付通道 - 三个截然不同的第2层系统。正在进行连接所有其他类型的第1层和第2层系统的工作（你应该[参与其中！][17]）。

----------------------------------------------------
--------------------------------------------

# 第三层是为了互操作性

## 价值互联网的协议栈

像[Lightning][1]和[Plasma][2]这样的第2层技术被称为[“在可扩展性，互操作性和功能性方面取得重大进展”][3]用于区块链。但是，大多数第2层项目主要关注可扩展性，偶尔也会提到互操作性。为什么？这不仅仅是时间或发展阶段的问题。实际上它应该是这样的，因为**第2层用于扩展。第3层用于互操作性。**

扩展和互操作性是互补的，但是通过不同的协议层可以最好地解决这些问题。为了说明这一点，我将介绍分层协议体系结构的目的以及第1,2和3层的角色。我还将解释分离可伸缩性和互操作性如何改进两者的解决方案并铺平价值互联网的方式，其设计与互联网本身惊人地类似。

### 分层协议的目的

> 始终可以将多个单独的问题凝聚成一个复杂的相互依赖的解决方案。在大多数情况下，这是一个坏主意。_
_\- [RFC 1925：十二网络真相][4]

互联网是分层协议架构的最佳范例，这种设计是互联网增长和实用性的关键因素。不同的功能部分被分成彼此构建的单独协议，而不是在一个单片系统中捆绑在一起。

例如，因特网协议（IP）建立在不同的底层网络技术或“链路层”协议上，例如以太网和WiFi。由于IP被设计为单独的层，因此它不依赖于任何特定的网络技术，并且能够以相同的方式在许多不同类型的有线或无线连接上工作。

![][5]

互联网的“沙漏”架构：IP抽象了底层网络和基于它构建的应用程序之间的差异

分层协议架构提供了许多重要的好处：

**互操作性**IP可以通过抽象出差异来适用于许多不同的网络技术。只要链接可以发送数据，IP就可以通过它进行通信。这意味着无论我们使用何种类型的底层网络，我们都可以无缝连接。
**可升级性**抽象可以使不同的层分别进化。虽然互联网是在20世纪70年代建立的，但IP抽象出不同的网络技术这一事实使我们能够从拨号升级到光纤和4G链路。更高级别的协议不需要改变，但随着更新的网络技术的发展，我们的连接越来越快。
**多用途案例的通用基础设施**IP也独立于任何特定用例，这使得相同的基础架构可用于从Web到电子邮件和IP语音（VoIP）的应用程序。如果互联网是专门为文件传输而构建的，那么我们可能需要为每个不同的用例提供完整的独立网络。相反，我们有一个可用于多种类型通信的互联网。

分层是设计互联网或价值互联网等系统的重要工具，但决定哪些特征适合哪些层是最难的部分。太多的层使系统过于复杂，但过多的捆绑会妨碍互操作性和可升级性。

### 价值互联网的协议栈

Interledger协议栈与互联网协议套件有直接的相似之处，主要是因为我们发现将功能拆分为类似层有助于解决每个级别的问题。在这里，我将简要介绍每个层来解释它们的作用，并展示将第3层集中在互操作性上的好处。

![][6]

Interledger Protocol（ILP）连接并抽象出第2层技术之间的差异

### 第1层：账本

区块链和其他类型的分类帐就像支撑互联网的物理电缆。数字通信最终通过有线和无线链路实现，这些链路连接各个设备并在它们之间传输数据。同样，分类账是价值互联网的基础，因为它们使两个接受同一资产的人或在同一系统中持有账户进行交易。

与物理电缆，分类账和区块链一样，需要在其上构建额外的协议，以便于数据或资金的交换。在区块链的情况下，主要问题是缩放交易吞吐量和降低延迟，同时保持去中心化。

分类帐注定会成为性能瓶颈，因为它们在逻辑上是集中的。无论分类账是以集中还是去中心化的方式维护，它都需要一个统一的，共享的账户和余额状态，以确保资金不会“双重花费”。更新广泛共享状态总是相对昂贵且缓慢。瓶颈将是分布式账本中的共识速度，或者是集中式分类账中单台机器的性能。提高分类帐可伸缩性非常有用，但使用第2层协议从主分类帐中移除常见和重复交易将提高吞吐量并降低延迟。

### 第2层：局域网

用于缩放区块链的第2层解决方案类似于互联网堆栈的链路层协议，例如以太网和WiFi。该层创建双边链路或局域网（LAN）*，允许直接连接的各方或设备通过底层网络进行有效通信。

区块链的第2层技术旨在通过使用一种程序化托管方式在底层分类账上实现快速，廉价，高吞吐量的交易。此类别包括[支付通道][7]和[广义状态通道][8]等双边技术，以及包括[闪电网络][9]和[雷电网络][10]，[侧链]等支付通道网络的多边解决方案[11]，和[等离子][12]。通过允许成对或较小的账户持有者组进行交易而不需要每次与主分类账交互，这些中的每一个都能够实现更快，更便宜的交易。

第2层解决方案的核心机制是程序化托管的一种形式。资产首先被放入主分类账的持有账户，脚本或智能合约中。然后，两个或更多方可以通过更新其本地状态来执行多次快速交易以改变托管资产的分配。如果当事人想要结束其分类账关系，他们会将最终状态呈现给主分类账，主分类账检查其有效性并相应地分配托管资产。

重要的是，底层分类帐提供的功能直接决定了第2层系统可以包含的功能类型，因为分类帐在它们支持的程序托管类型方面有所不同。

> 第2层解决方案必然与某些分类账相关联，因为它们利用底层第1层系统中的特定功能。

这就是为什么[闪电网络是根据比特币脚本定义][13]，[雷电网络使用特定的以太坊智能合约][14]，等离子实现同样会使用明确指定的智能合约。 闪电网络可以使用比特币（如Litecoin）的特定（SegWit支持）分叉，Raiden和Plasma可以与使用以太坊虚拟机（EVM）的其他区块链一起使用。但是，如果每个第2层技术试图支持具有完全不同功能集的分类账（例如，[没有SegWit的Lightning][15]或仅使用比特币脚本实现的Plasma），则每个第2层技术会更糟。这完全没问题！第2层扩展解决方案可以并且应该利用底层分类帐提供的每个功能。

第1层和第2层之间的紧密连接正是我们需要一个单独的互操作层的原因。真正的互操作性完全取决于抽象，并且需要最小化协议使用的功能集。互操作层期望从下面的层中获得的功能越少，它可以连接的异构网络就越多。由于第2层解决方案可以并且应该利用特定的第1层功能，因此我们需要一个单独的互操作层，使用尽可能少的分类帐特定功能。

### 第3层：互操作性

第3层的目的是抽象出不同的第1层和第2层技术之间的差异，以连接不同类型的网络。这是互联网上的互联网协议（IP）和价值互联网中的Interledger协议（ILP）的作用。

互联网堆栈的核心协议IP通过网络路由数据包，同时抽象出底层电信技术之间的差异。互联网之所以成功，恰恰是因为它使用了如此简洁的抽象，能够连接一切，从电话线（通过拨号）到蜂窝和卫星网络，再到专用光缆 - 甚至[载体鸽][16] 。

IP需要底层网络的唯一功能是发送数据的能力。它不依赖于任何附加功能，甚至不依赖于速度或可靠性。由于其简单的抽象，IP能够创建一个通用的网络网络，如今连接了超过一半的人口。

#### 第2层网络上的最小抽象

在价值互联网中，ILP打包像IP打包数据一样的价值。它通过网络路由数据包，同时抽象出资产和分类账或第2层技术之间的差异。与IP一样，ILP的核心是与网络无关的数据包和地址格式。

**ILP对底层的唯一要求是能够发送值。**它不需要任何特殊的交易类型，功能或程序化托管。更快，更便宜的交易改善了用户体验，但即使它们也不是严格要求的。

ILP的最小抽象实现了与所有类型的第1层和第2层网络的互操作性，包括那些不能设计为可互操作的网络。到目前为止，它已被用于连接比特币闪电网络，双边以太坊支付通道和XRP支付通道 - 三个截然不同的第2层系统。正在进行连接所有其他类型的第1层和第2层系统的工作（你应该[参与其中！][17]）。

有关协议如何工作的完整描述，请参阅[Interledger：如何互连所有区块链和价值网络][18]。要查看从ILP中删除的所有功能，以使核心协议和抽象尽可能简单和可互操作，请阅读[简化Interledger：可能的协议功能的墓地][19]。

_Layers 4和5不是这篇文章的重点，但你可以阅读[__STREAMing Money and Data Over ILP_][20]_来了解STREAM，这是一个受[__QUIC_][21]_启发的推荐的第4层传输协议。留意第5层的未来帖子以及基于ILP和STREAM构建的特定于应用程序的协议。

### 结论：分离缩放和互操作性

扩展和互操作性是互补的，但它们是基本上不同类型的问题，最好通过单独的协议层解决。 Lightning和Plasma等可扩展性解决方案在利用其底层分类账提供的全部功能时效果最佳。相比之下，像Interledger这样的互操作性协议需要最少的抽象，使它们能够跨越不同类型的底层网络。

分离链路层和互操作性层的一个微妙好处是因为互联网今天仍然有用。互联网协议是为计算机设计的 - 房间大小_但它仍然适用于手机和物联网设备。通过降低底层网络所需的IP功能，它还允许在底层技术方面进行重大改进。如果IP是在开发时基于网络的特定功能或API构建的，那么这是不可能的。

我们还远未结束第1层和第2层区块链或分类帐系统的开发。通过抽象这些与第3层之间的差异，我们可以构建更好的，更加技术无关的用户体验，同时允许未来的发展，使互联网价值更快，更便宜，更高效。

![][22]

[1]: https://lightning.network
[2]: https://plasma.io
[3]: https://www.coindesk.com/layer-2-blockchain-tech-even-bigger-deal-think/
[4]: https://tools.ietf.org/html/rfc1925
[5]: https://cdn-images-1.medium.com/max/1600/1*-jsi9gHospcC2Cd5nR9lJw.png
[6]: https://cdn-images-1.medium.com/max/1600/1*n7X3cGN2J2T2doadWTnfXg.png
[7]: https://en.bitcoin.it/wiki/Payment_channels
[8]: https://medium.com/l4-media/generalized-state-channels-on-ethereum-de0357f5fb44
[9]: http://lightning.network/
[10]: https://raiden.network/
[11]: https://www.blockstream.com/sidechains.pdf
[12]: https://www.plasma.io/
[13]: https://github.com/lightningnetwork/lightning-rfc/blob/master/03-transactions.md
[14]: https://raiden-network.readthedocs.io/en/stable/spec.html
[15]: https://segwit.org/is-segregated-witness-necessary-to-implement-the-lightning-network-6c4545a9f9f1
[16]: https://www.blug.linux.no/rfc1149/writeup/
[17]: https://interledger.org/community.html
[18]: https://medium.com/xpring/interledger-how-to-interconnect-all-blockchains-and-value-networks-74f432e64543
[19]: https://medium.com/interledger-blog/simplifying-interledger-the-graveyard-of-possible-protocol-features-b35bf67439be
[20]: https://medium.com/interledger-blog/streaming-money-and-data-over-ilp-fabd76fc991e
[21]: https://en.wikipedia.org/wiki/QUIC
[22]: https://cdn-images-1.medium.com/max/1600/1*7hlPpmJCRNhI_IlF1Th30g.png


#### 区块链中文字幕组

致力于前沿区块链知识和信息的传播，为中国融入全球区块链世界贡献一份力量。

如果您懂一些技术、懂一些英文，欢迎加入我们，加微信号:w1791520555。

[点击查看项目GITHUB，及更多的译文...](https://github.com/BlockchainTranslator/EOS)

#### 本文译者简介

小丹 区块链技术爱好者  热衷于区块链底层技术研究

版权所有，转载需完整注明以上内容。

----------------------------------------------------
